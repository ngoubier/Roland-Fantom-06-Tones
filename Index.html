
<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <title>Roland Fantom-06 – Liste des sons</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <style>
    :root {
      --bg: #050814;
      --bg-card: #101727;
      --bg-card-soft: #151d30;
      --accent: #4cafef;
      --accent-soft: rgba(76, 175, 239, 0.12);
      --text: #f3f5ff;
      --text-soft: #a8b3d9;
      --border: #222a3d;
      --danger: #ff4c6a;
    }

    * {
      box-sizing: border-box;
    }

    body {
      margin: 0;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI",
        sans-serif;
      background: radial-gradient(circle at top, #14203d, #050814 55%);
      color: var(--text);
    }

    main {
      max-width: 1200px;
      margin: 0 auto;
      padding: 12px 10px 32px;
    }

    header {
      margin-bottom: 12px;
    }

    header h1 {
      font-size: 1.4rem;
      margin: 0 0 4px;
    }

    header p {
      margin: 0;
      font-size: 0.8rem;
      color: var(--text-soft);
    }

    .card {
      background: linear-gradient(135deg, var(--bg-card), var(--bg-card-soft));
      border-radius: 12px;
      border: 1px solid var(--border);
      padding: 10px;
      box-shadow: 0 12px 30px rgba(0, 0, 0, 0.45);
    }

    .filters {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      margin-bottom: 8px;
    }

    .filter-group {
      flex: 1 1 120px;
      min-width: 120px;
      display: flex;
      flex-direction: column;
      gap: 3px;
    }

    .filter-group label {
      font-size: 0.7rem;
      color: var(--text-soft);
    }

    .filter-group select,
    .filter-group input {
      border-radius: 999px;
      border: 1px solid var(--border);
      background: #050814;
      color: var(--text);
      padding: 6px 9px;
      font-size: 0.75rem;
      outline: none;
      width: 100%;
    }

    .filter-group select:focus,
    .filter-group input:focus {
      border-color: var(--accent);
      box-shadow: 0 0 0 1px var(--accent-soft);
    }

    .search-input {
      padding-left: 30px;
      background-image: radial-gradient(circle, var(--accent) 1px, transparent 1px);
      background-repeat: no-repeat;
      background-position: 10px 50%;
      background-size: 12px 12px;
    }

    .summary-bar {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 8px;
      font-size: 0.75rem;
      color: var(--text-soft);
    }

    .summary-bar strong {
      color: var(--accent);
    }

    .page-size {
      display: inline-flex;
      align-items: center;
      gap: 4px;
    }

    .page-size select {
      width: auto;
      padding: 4px 8px;
      border-radius: 999px;
      border: 1px solid var(--border);
      background: #050814;
      color: var(--text);
      font-size: 0.7rem;
    }

    .table-container {
      border-radius: 10px;
      border: 1px solid var(--border);
      background: rgba(5, 8, 20, 0.9);
      overflow-x: auto;
      -webkit-overflow-scrolling: touch;
      scrollbar-width: thin;
    }

    table {
      border-collapse: collapse;
      width: 100%;
      min-width: 640px; /* scroll horizontal sur mobile, au lieu de casser la mise en page */
      font-size: 0.75rem;
    }

    thead {
      background: linear-gradient(
        90deg,
        rgba(76, 175, 239, 0.16),
        rgba(76, 175, 239, 0.02)
      );
    }

    th,
    td {
      padding: 6px 8px;
      text-align: left;
      border-bottom: 1px solid rgba(34, 42, 61, 0.7);
      white-space: nowrap;
    }

    th {
      position: sticky;
      top: 0;
      z-index: 1;
      font-weight: 600;
      color: var(--text-soft);
      backdrop-filter: blur(8px);
    }

    tbody tr:nth-child(even) {
      background: rgba(255, 255, 255, 0.02);
    }

    tbody tr:hover {
      background: rgba(76, 175, 239, 0.08);
    }

    .tone-name {
      font-weight: 600;
      color: #ffffff;
    }

    .tone-bank {
      font-family: "SF Mono", ui-monospace, Menlo, Monaco, Consolas,
        "Liberation Mono", "Courier New", monospace;
      font-size: 0.7rem;
      padding-inline-end: 0;
    }

    .tone-num {
      font-family: "SF Mono", ui-monospace, Menlo, Monaco, Consolas,
        "Liberation Mono", "Courier New", monospace;
      font-size: 0.7rem;
    }

    .tone-category {
      font-size: 0.7rem;
      color: var(--text-soft);
    }

    .tone-type-pill {
      font-size: 0.65rem;
      padding: 2px 7px;
      border-radius: 999px;
      border: 1px solid rgba(76, 175, 239, 0.5);
      background: rgba(76, 175, 239, 0.12);
      color: var(--accent);
      white-space: nowrap;
    }

    .midi-cell {
      font-family: "SF Mono", ui-monospace, Menlo, Monaco, Consolas,
        "Liberation Mono", "Courier New", monospace;
      font-size: 0.68rem;
      color: var(--text-soft);
    }

    .pagination {
      display: flex;
      justify-content: center;
      align-items: center;
      gap: 6px;
      margin-top: 10px;
      flex-wrap: wrap;
      font-size: 0.75rem;
    }

    .pagination button {
      border-radius: 999px;
      border: 1px solid var(--border);
      background: #050814;
      color: var(--text);
      padding: 4px 9px;
      font-size: 0.75rem;
      min-width: 32px;
      cursor: pointer;
    }

    .pagination button.current {
      background: var(--accent);
      border-color: var(--accent);
      color: #050814;
      font-weight: 600;
    }

    .pagination button:disabled {
      opacity: 0.35;
      cursor: default;
    }

    .pagination span {
      color: var(--text-soft);
    }

    .badge-warning {
      color: var(--danger);
      font-size: 0.7rem;
    }

    /* Mobile first adjustments */
    @media (max-width: 600px) {
      main {
        padding-inline: 8px;
      }

      header h1 {
        font-size: 1.1rem;
      }

      header p {
        font-size: 0.72rem;
      }

      .card {
        padding: 8px;
        border-radius: 10px;
      }

      .filters {
        gap: 6px;
      }

      .filter-group {
        flex: 1 1 100%;
      }

      .filter-group select,
      .filter-group input {
        font-size: 0.7rem;
        padding: 6px 9px;
      }

      .summary-bar {
        flex-direction: column;
        align-items: flex-start;
        gap: 4px;
      }

      table {
        font-size: 0.72rem;
      }

      th,
      td {
        padding: 5px 6px;
      }

      .tone-type-pill {
        font-size: 0.62rem;
      }

      .badge-warning {
        font-size: 0.65rem;
      }
    }
  </style>
</head>
<body>
  <main>
    <header>
      <h1>Fantom-06 – Liste des sons (CSV)</h1>
      <p>
        Chargement depuis <code>fantom06_sounds_processed.csv</code> – filtres
        + recherche + pagination. Optimisé pour écran de smartphone.
      </p>
    </header>

    <section class="card">
      <div class="filters">
        <div class="filter-group">
          <label for="bankFilter">Banque</label>
          <select id="bankFilter">
            <option value="">Toutes les banques</option>
          </select>
        </div>

        <div class="filter-group">
          <label for="categoryFilter">Catégorie</label>
          <select id="categoryFilter">
            <option value="">Toutes les catégories</option>
          </select>
        </div>

        <div class="filter-group">
          <label for="typeFilter">Type de son</label>
          <select id="typeFilter">
            <option value="">Tous les types</option>
          </select>
        </div>

        <div class="filter-group">
          <label for="searchInput">Recherche (nom, banque, mot-clé)</label>
          <input
            id="searchInput"
            type="search"
            placeholder="Ex. &quot;AnalogAtmosphere&quot;, &quot;Brass&quot;..."
            class="search-input"
          />
        </div>
      </div>

      <div class="summary-bar">
        <div id="summaryText">Chargement des sons...</div>
        <div class="page-size">
          <span>Par page&nbsp;:</span>
          <select id="pageSize">
            <option value="25">25</option>
            <option value="50">50</option>
            <option value="100">100</option>
          </select>
        </div>
      </div>

      <div class="table-container">
        <table>
          <thead>
            <tr>
              <th>Banque</th>
              <th>#</th>
              <th>Nom</th>
              <th>Catégorie</th>
              <th>Type</th>
              <th>MSB</th>
              <th>LSB</th>
              <th>PC</th>
            </tr>
          </thead>
          <tbody id="tonesBody">
            <tr>
              <td colspan="8">Chargement en cours…</td>
            </tr>
          </tbody>
        </table>
      </div>

      <div class="pagination" id="pagination"></div>

      <p class="badge-warning">
        Si rien ne s’affiche&nbsp;: vérifie que le fichier
        <code>fantom06_sounds_processed.csv</code> se trouve dans le
        <strong>même dossier</strong> que ce fichier HTML (et que ton
        navigateur a le droit de lire les fichiers locaux).
      </p>
    </section>
  </main>

  <script>
    const STATE = {
      all: [],
      filtered: [],
      page: 1,
      pageSize: 25,
      bank: "",
      category: "",
      toneType: "",
      search: "",
    };

    function parseCSV(text) {
      const lines = text.split(/\r?\n/).filter((l) => l.trim().length > 0);
      if (!lines.length) return [];

      const headers = lines[0].split(",");
      const idx = {};
      headers.forEach((h, i) => {
        idx[h.trim()] = i;
      });

      const out = [];
      for (let i = 1; i < lines.length; i++) {
        const line = lines[i];
        const cols = line.split(",");

        const get = (name) => {
          const pos = idx[name];
          if (pos == null || pos >= cols.length) return "";
          return cols[pos].trim();
        };

        const msb = Number(get("msb"));
        const lsb = Number(get("lsb"));
        const pc = Number(get("pc"));

        out.push({
          number: get("number"),
          name: get("name"),
          bank: get("bank"),
          category: get("category"),
          toneType: get("toneType"),
          msb: Number.isFinite(msb) ? msb : null,
          lsb: Number.isFinite(lsb) ? lsb : null,
          pc: Number.isFinite(pc) ? pc : null,
          keywords: get("keywords") || "",
        });
      }
      return out;
    }

    function populateFilters(data) {
      const bankSelect = document.getElementById("bankFilter");
      const catSelect = document.getElementById("categoryFilter");
      const typeSelect = document.getElementById("typeFilter");

      const banks = [...new Set(data.map((d) => d.bank).filter(Boolean))].sort();
      const cats = [
        ...new Set(data.map((d) => d.category).filter(Boolean)),
      ].sort();
      const types = [
        ...new Set(data.map((d) => d.toneType).filter(Boolean)),
      ].sort();

      for (const b of banks) {
        const opt = document.createElement("option");
        opt.value = b;
        opt.textContent = b;
        bankSelect.appendChild(opt);
      }

      for (const c of cats) {
        const opt = document.createElement("option");
        opt.value = c;
        opt.textContent = c;
        catSelect.appendChild(opt);
      }

      for (const t of types) {
        const opt = document.createElement("option");
        opt.value = t;
        opt.textContent = t;
        typeSelect.appendChild(opt);
      }
    }

    function applyFilters() {
      const { all, bank, category, toneType, search, pageSize } = STATE;
      const q = (search || "").toLowerCase();

      let filtered = all.filter((d) => {
        if (bank && d.bank !== bank) return false;
        if (category && d.category !== category) return false;
        if (toneType && d.toneType !== toneType) return false;

        if (q) {
          const haystack =
            (d.name || "") +
            " " +
            (d.bank || "") +
            " " +
            (d.category || "") +
            " " +
            (d.keywords || "") +
            " " +
            (d.number || "");
          if (!haystack.toLowerCase().includes(q)) return false;
        }
        return true;
      });

      // Tri: banque puis numéro de programme (PC)
      filtered.sort((a, b) => {
        const bankCmp = (a.bank || "").localeCompare(b.bank || "");
        if (bankCmp !== 0) return bankCmp;
        const pcA = a.pc || 0;
        const pcB = b.pc || 0;
        return pcA - pcB;
      });

      STATE.filtered = filtered;
      STATE.page = 1;
      render();
    }

    function render() {
      const tbody = document.getElementById("tonesBody");
      const pag = document.getElementById("pagination");
      const summary = document.getElementById("summaryText");

      const total = STATE.filtered.length;
      const pageSize = STATE.pageSize;
      const totalPages = Math.max(1, Math.ceil(total / pageSize));

      if (STATE.page > totalPages) STATE.page = totalPages;

      const startIndex = (STATE.page - 1) * pageSize;
      const endIndex = Math.min(startIndex + pageSize, total);
      const pageRows = STATE.filtered.slice(startIndex, endIndex);

      if (!total) {
        tbody.innerHTML =
          '<tr><td colspan="8">Aucun son trouvé pour ces filtres.</td></tr>';
      } else {
        tbody.innerHTML = pageRows
          .map((d) => {
            const msb = d.msb != null ? d.msb : "";
            const lsb = d.lsb != null ? d.lsb : "";
            const pc = d.pc != null ? d.pc : "";

            return `
              <tr>
                <td class="tone-bank">${d.bank || ""}</td>
                <td class="tone-num">${d.number || ""}</td>
                <td class="tone-name">${d.name || ""}</td>
                <td class="tone-category">${d.category || ""}</td>
                <td><span class="tone-type-pill">${d.toneType || ""}</span></td>
                <td class="midi-cell">${msb}</td>
                <td class="midi-cell">${lsb}</td>
                <td class="midi-cell">${pc}</td>
              </tr>
            `;
          })
          .join("");
      }

      summary.textContent = total
        ? `${total} sons – page ${STATE.page}/${totalPages}`
        : "0 son – ajustez vos filtres ou la recherche.";

      // Pagination
      pag.innerHTML = "";

      const addBtn = (label, page, disabled, isCurrent) => {
        const btn = document.createElement("button");
        btn.textContent = label;
        if (isCurrent) btn.classList.add("current");
        btn.disabled = disabled;
        if (!disabled) {
          btn.addEventListener("click", () => {
            STATE.page = page;
            render();
          });
        }
        pag.appendChild(btn);
      };

      addBtn("«", 1, STATE.page === 1, false);
      addBtn("‹", STATE.page - 1, STATE.page === 1, false);

      const spread = 2;
      const start = Math.max(1, STATE.page - spread);
      const end = Math.min(totalPages, STATE.page + spread);

      for (let p = start; p <= end; p++) {
        addBtn(p.toString(), p, false, p === STATE.page);
      }

      addBtn("›", STATE.page + 1, STATE.page === totalPages, false);
      addBtn("»", totalPages, STATE.page === totalPages, false);
    }

    async function init() {
      try {
        const res = await fetch("fantom06_sounds_processed.csv");
        if (!res.ok) {
          throw new Error("Impossible de charger le CSV");
        }
        const text = await res.text();
        const data = parseCSV(text);
        STATE.all = data;
        populateFilters(data);
        applyFilters();
      } catch (err) {
        console.error(err);
        const tbody = document.getElementById("tonesBody");
        tbody.innerHTML = `
          <tr>
            <td colspan="8">
              Erreur lors du chargement du CSV :
              <span class="badge-warning">${err.message}</span>
            </td>
          </tr>`;
        document.getElementById("summaryText").textContent =
          "Erreur de chargement du fichier CSV.";
      }
    }

    // Écouteurs
    document.getElementById("bankFilter").addEventListener("change", (e) => {
      STATE.bank = e.target.value;
      applyFilters();
    });

    document
      .getElementById("categoryFilter")
      .addEventListener("change", (e) => {
        STATE.category = e.target.value;
        applyFilters();
      });

    document.getElementById("typeFilter").addEventListener("change", (e) => {
      STATE.toneType = e.target.value;
      applyFilters();
    });

    document
      .getElementById("pageSize")
      .addEventListener("change", (e) => {
        STATE.pageSize = Number(e.target.value) || 25;
        STATE.page = 1;
        render();
      });

    let searchTimeout = null;
    document.getElementById("searchInput").addEventListener("input", (e) => {
      const value = e.target.value;
      clearTimeout(searchTimeout);
      searchTimeout = setTimeout(() => {
        STATE.search = value;
        applyFilters();
      }, 150);
    });

    init();
  </script>
</body>
</html>
```0
